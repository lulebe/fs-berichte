{% extends "app/appbase.twig" %}

{% block title %}PaLMe Admin{% endblock %}
{% block head %}
<style>
  .maintextarea img {
    max-width: 100%;
    max-height: 500px;
  }
</style>
{% endblock %}

{% block content %}
<div class="wrapper" v-scope @vue:mounted="mounted">
  <a href="/app/admin/awards/{{award.id}}"><i class="material-icons">arrow_back</i> {{award.title}}</a>
  <h1>{{candidate.name}}</h1>
  <a href="/app/admin/awards/{{award.id}}/candidates/{{candidate.id}}/delete" class="btn iconbtn important"><i class="material-icons">delete</i> l√∂schen</a><br><br>
  <div class="card mb" style="padding: 0;">
    <div class="gallery">
      <div class="gallery-image" v-for="(image, i) in bgImages" :style="{'background-image': image}" :class="{visible: i == currentImage}"></div>
    </div>
  </div>
  <div class="card maintextarea usertext">
    {{candidate.longDescriptionHtml | raw}}    
  </div>
</div>
{% endblock %}

{% block js %}
<script src="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.iife.js"></script>
<script>
  const award = {{award | json_encode | raw }}
  const candidate = {{candidate | json_encode | raw }}
  PetiteVue.createApp({
  $delimiters: ['${', '}'],

  award,
  candidate,
  currentImage: 0,

  get bgImages () {
    return this.candidate.CandidateImages.map(image => `url("/app/awards/image/${image.id}.${image.type}")`)
  },

  mounted () {
    console.log(this.bgImages)
    setInterval(() => {
      this.currentImage = (this.currentImage + 1) % this.bgImages.length
    }, 5000)
  }

}).mount()
</script>
{% endblock %}